<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Apps Analytics Viewer</title>

<style>

body{
margin:0;
font-family:system-ui;
background:#e6ebf2;
}

.header{
text-align:center;
font-size:26px;
padding:20px;
font-weight:bold;
}

/* neumorphic card */

.card{
margin:15px;
padding:20px;
border-radius:20px;
background:#e6ebf2;
box-shadow:8px 8px 16px #c5cad1,-8px -8px 16px white;
}

.input{
width:100%;
padding:12px;
border:none;
border-radius:15px;
background:#e6ebf2;
box-shadow:inset 5px 5px 10px #c5cad1,inset -5px -5px 10px white;
}

.button{
padding:10px;
margin-top:10px;
border:none;
border-radius:12px;
background:#e6ebf2;
box-shadow:5px 5px 10px #c5cad1,-5px -5px 10px white;
cursor:pointer;
}

.viewer{
display:none;
padding:10px;
}

.contact{
padding:15px;
margin-bottom:12px;
border-radius:15px;
background:#e6ebf2;
box-shadow:5px 5px 10px #c5cad1,-5px -5px 10px white;
}

.contactName{
font-weight:bold;
margin-bottom:5px;
}

.numberRow{
display:flex;
align-items:center;
justify-content:space-between;
margin-bottom:4px;
}

.icons img{
width:20px;
margin-left:10px;
cursor:pointer;
}

/* alphabet sidebar */

.sidebar{
position:fixed;
right:5px;
top:100px;
font-size:12px;
}

.sidebar div{
padding:2px;
cursor:pointer;
}

/* stats */

.stats{
font-size:14px;
margin-bottom:10px;
}

/* country filter */

.country{
display:inline-block;
padding:5px 10px;
margin:3px;
border-radius:10px;
background:#e6ebf2;
box-shadow:5px 5px 10px #c5cad1,-5px -5px 10px white;
cursor:pointer;
}

</style>
</head>
<body>

<div class="header">Apps Analytics Viewer</div>

<div class="card" id="loader">

Load JSON link:

<input id="linkInput" class="input"
value="https://raw.githubusercontent.com/MOFO-UG/ControlTheWorld/main/SM-E156B/Example/18-02-2026/example.json">

<button class="button" onclick="loadFromLink()">Load</button>

<textarea id="pasteInput" class="input"></textarea>

<input type="file" onchange="loadFile(event)" class="input">

</div>

<div class="viewer" id="viewer">

<div class="stats" id="stats"></div>

<input class="input" id="search" placeholder="Search..."
oninput="search()">

<br><br>

<button class="button" onclick="showDuplicates()">Show Only Duplicates</button>

<button class="button" onclick="sortAZ()">Sort A-Z</button>

<button class="button" onclick="sortZA()">Sort Z-A</button>

<div id="countryFilter"></div>

<div id="contacts"></div>

</div>

<div class="sidebar" id="sidebar"></div>

<script>

let contacts=[]
let filtered=[]
let countryStats={}

/* normalize */

function normalize(num){
return num.replace(/\D/g,'').slice(-10)
}

/* format */

function format(num){
let n=normalize(num)
return "+91 "+n.slice(0,5)+" "+n.slice(5)
}

/* country detect */

function detectCountry(num){

let digits=num.replace(/\D/g,'')

if(digits.startsWith("91")) return "India"
if(digits.startsWith("977")) return "Nepal"
if(digits.startsWith("1")) return "USA"
if(digits.startsWith("44")) return "UK"
if(digits.startsWith("61")) return "Australia"
if(digits.startsWith("49")) return "Germany"
if(digits.startsWith("33")) return "France"
if(digits.startsWith("971")) return "UAE"
if(digits.startsWith("65")) return "Singapore"

return "Other"

}

/* merge */

function process(data){

let map=new Map()

data.forEach(c=>{

let name=c.name||"Unknown"
let norm=normalize(c.number)

if(!map.has(name))
map.set(name,new Set())

map.get(name).add(norm)

})

contacts=[]

map.forEach((numbers,name)=>{

numbers=[...numbers]

contacts.push({
name,
numbers,
duplicate:numbers.length>1
})

})

filtered=[...contacts]

buildCountryStats()

render()

}

/* render */

function render(){

let html=""

filtered.forEach(c=>{

html+=`<div class="contact">
<div class="contactName">${c.name}</div>`

c.numbers.forEach(n=>{

let full="+91"+n

html+=`
<div class="numberRow">

<div>${format(n)}</div>

<div class="icons">

<img src="call.png"
onclick="call('${full}')">

<img src="whatsapp.png"
onclick="whatsapp('${full}')">

<img src="copy.png"
onclick="copy('${full}')">

</div>

</div>
`

})

html+="</div>"

})

document.getElementById("contacts").innerHTML=html

updateStats()

}

/* stats */

function updateStats(){

let totalContacts=contacts.length

let totalNumbers=contacts.reduce((a,c)=>a+c.numbers.length,0)

document.getElementById("stats").innerHTML=
`Total Contacts: ${totalContacts}
<br>
Total Numbers: ${totalNumbers}`

}

/* search */

function search(){

let q=document.getElementById("search").value.toLowerCase()

filtered=contacts.filter(c=>{

if(c.name.toLowerCase().includes(q)) return true

return c.numbers.some(n=>n.includes(q))

})

render()

}

/* duplicate filter */

function showDuplicates(){

filtered=contacts.filter(c=>c.duplicate)

render()

}

/* sort */

function sortAZ(){

filtered.sort((a,b)=>a.name.localeCompare(b.name))
render()

}

function sortZA(){

filtered.sort((a,b)=>b.name.localeCompare(a.name))
render()

}

/* country stats */

function buildCountryStats(){

countryStats={}

contacts.forEach(c=>{

c.numbers.forEach(n=>{

let country=detectCountry(n)

countryStats[country]=(countryStats[country]||0)+1

})

})

let html=""

Object.entries(countryStats)
.forEach(([country,count])=>{

html+=`
<div class="country"
onclick="filterCountry('${country}')">

${country} (${count})

</div>
`

})

document.getElementById("countryFilter").innerHTML=html

}

function filterCountry(country){

filtered=contacts.filter(c=>
c.numbers.some(n=>detectCountry(n)==country)
)

render()

}

/* alphabet sidebar */

let letters="ABCDEFGHIJKLMNOPQRSTUVWXYZ"

let sidebar=""

letters.split("").forEach(l=>{

sidebar+=`<div onclick="jump('${l}')">${l}</div>`

})

document.getElementById("sidebar").innerHTML=sidebar

function jump(letter){

let el=[...document.getElementsByClassName("contact")]
.find(e=>e.innerText.startsWith(letter))

if(el) el.scrollIntoView()

}

/* buttons */

function call(n){

location.href="tel:"+n

}

function whatsapp(n){

window.open("https://wa.me/"+n)

}

function copy(n){

navigator.clipboard.writeText(n)

}

/* load */

async function loadFromLink(){

let res=await fetch(document.getElementById("linkInput").value)

let json=await res.json()

document.getElementById("loader").style.display="none"

document.getElementById("viewer").style.display="block"

process(json)

}

function loadFile(e){

let reader=new FileReader()

reader.onload=x=>{

process(JSON.parse(x.target.result))

}

reader.readAsText(e.target.files[0])

}

</script>

</body>
</html>
