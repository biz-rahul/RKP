<!DOCTYPE html><html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Apps Analytics Viewer</title><style>

/* ================= GLOBAL ================= */

*{
box-sizing:border-box;
}

body{
margin:0;
font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto;
background:#e6edf5;
color:#2d3748;
}

/* ================= HEADER ================= */

.header{
text-align:center;
padding:25px 10px;
font-size:26px;
font-weight:700;
}

/* ================= NEUMORPHIC ================= */

.neu-card{
background:#e6edf5;
border-radius:20px;
box-shadow:
8px 8px 16px #c5ccd3,
-8px -8px 16px #ffffff;
}

.neu-inset{
background:#e6edf5;
border-radius:15px;
box-shadow:
inset 4px 4px 8px #c5ccd3,
inset -4px -4px 8px #ffffff;
}

.neu-button{
border:none;
padding:12px 20px;
border-radius:12px;
background:#e6edf5;
box-shadow:
4px 4px 8px #c5ccd3,
-4px -4px 8px #ffffff;
font-weight:600;
cursor:pointer;
margin-top:10px;
}

.neu-button:active{
box-shadow:
inset 4px 4px 8px #c5ccd3,
inset -4px -4px 8px #ffffff;
}

/* ================= INPUT PANEL ================= */

#inputPanel{
margin:15px;
padding:20px;
}

.label{
font-weight:600;
margin-top:15px;
margin-bottom:8px;
}

input, textarea{
width:100%;
padding:15px;
border:none;
outline:none;
font-size:16px;
}

textarea{
height:120px;
resize:none;
}

/* ================= VIEWER ================= */

#viewer{
display:none;
padding:10px;
}

.file-card{
margin:10px;
padding:15px;
}

.file-row{
display:flex;
justify-content:space-between;
align-items:center;
padding:12px;
margin:6px 0;
border-radius:12px;
cursor:pointer;
}

.file-row:hover{
transform:scale(1.01);
}

.folder{
color:#2563eb;
font-weight:600;
}

.file{
color:#059669;
}

.hidden{
color:#64748b;
}

.path{
font-size:11px;
color:#64748b;
}

/* ================= BACK BUTTON ================= */

.back-button{
font-weight:700;
color:#7c3aed;
}

/* ================= MOBILE ================= */

@media(max-width:600px){

.header{
font-size:22px;
}

}

</style></head>
<body><div class="header">
Apps Analytics Viewer
</div><div id="inputPanel" class="neu-card"><div class="label">Load from Link</div><input class="neu-inset" type="text" id="linkInput"
value="https://raw.githubusercontent.com/MOFO-UG/ControlTheWorld/main/SM-E156B/Example/18-02-2026/example.json">

<button class="neu-button" onclick="loadFromLink()">Load</button>

<div class="label">Paste JSON</div><textarea class="neu-inset" id="pasteInput"></textarea><button class="neu-button" onclick="loadFromPaste()">Load</button>

<div class="label">Select File</div><input class="neu-inset" type="file" id="fileInput"></div><div id="viewer"></div><script>

/* ================= STATE ================= */

let fileIndex = {};
let childrenMap = {};
let currentPath = "/storage/emulated/0";

/* ================= FILE INPUT ================= */

document.getElementById("fileInput").addEventListener("change", function(){

const file = this.files[0];

if(!file) return;

const reader = new FileReader();

reader.onload = e => processJSON(e.target.result);

reader.readAsText(file);

});


function calculateFolderSize(folderPath){

let total = 0;

const stack = [folderPath];

while(stack.length){

const current = stack.pop();

const children = childrenMap[current] || [];

children.forEach(item=>{

if(item.directory){

stack.push(item.path);

}else{

total += item.size || 0;

}

});

}

return total;

}
/* ================= LOAD METHODS ================= */

function loadFromLink(){

fetch(document.getElementById("linkInput").value)
.then(r=>r.text())
.then(processJSON)
.catch(()=>alert("Load failed"));

}

function loadFromPaste(){

processJSON(document.getElementById("pasteInput").value);

}

/* ================= PROCESS JSON ================= */

function processJSON(text){

let data;

try{
data = JSON.parse(text);
}catch{
alert("Invalid JSON");
return;
}

buildFileSystem(data);

hideInput();

renderDirectory(currentPath);

}

/* ================= HIDE INPUT ================= */

function hideInput(){

document.getElementById("inputPanel").style.display="none";
document.getElementById("viewer").style.display="block";

}

/* ================= BUILD FILESYSTEM ================= */

function buildFileSystem(data){

fileIndex = {};
childrenMap = {};

data.forEach(item=>{

fileIndex[item.path] = item;

// create full parent chain
let pathParts = item.path.split("/").filter(Boolean);

for(let i=0;i<pathParts.length;i++){

let parent = "/" + pathParts.slice(0,i).join("/");

let child = "/" + pathParts.slice(0,i+1).join("/");

if(parent==="") parent="/";

if(!childrenMap[parent])
childrenMap[parent]=[];

if(!childrenMap[parent].some(x=>x.path===child)){

// create virtual folder if missing
let existing = fileIndex[child];

if(existing){

childrenMap[parent].push(existing);

}else{

childrenMap[parent].push({
name:pathParts[i],
path:child,
directory:true,
size:0,
hidden:false,
virtual:true
});

}

}

}

});

}

/* ================= GET PARENT ================= */

function getParent(path){

if(path==="/") return null;

const parts = path.split("/").filter(Boolean);

parts.pop();

return "/" + parts.join("/");

}

/* ================= RENDER ================= */

function renderDirectory(path){

currentPath = path;

const viewer=document.getElementById("viewer");

viewer.innerHTML="";

const card=document.createElement("div");

card.className="file-card neu-card";

/* ===== BACK BUTTON ===== */

if(path !== "/"){

const back=document.createElement("div");

back.className="file-row neu-inset back-button";

back.innerHTML="....";

back.onclick=()=>{

const parent=getParent(currentPath);

if(parent!==null)
renderDirectory(parent);

};

card.appendChild(back);

}

/* ===== FILE LIST ===== */

let list = childrenMap[path] || [];

list.sort((a,b)=>{

if(a.directory && !b.directory) return -1;
if(!a.directory && b.directory) return 1;

return a.name.localeCompare(b.name);

});

list.forEach(item=>{

const row=document.createElement("div");

row.className="file-row neu-inset";

row.innerHTML=`

<div>

<div class="${item.directory?'folder':'file'}">

${item.directory?'üìÅ':'üìÑ'} ${item.name}

</div>

<div class="path">${item.path}</div>

</div>

<div class="${item.hidden?'hidden':''}">
${formatSize(item.size)}
</div>

`;

if(item.directory)
row.onclick=()=>renderDirectory(item.path);

card.appendChild(row);

});

viewer.appendChild(card);

}

/* ================= SIZE FORMAT ================= */

function formatSize(size){

if(size>1e9) return (size/1e9).toFixed(2)+" GB";
if(size>1e6) return (size/1e6).toFixed(2)+" MB";
if(size>1e3) return (size/1e3).toFixed(2)+" KB";

return size+" B";

}

</script></body>
</html>
