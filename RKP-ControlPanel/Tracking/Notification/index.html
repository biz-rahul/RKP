<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Apps Analytics Viewer</title>

<style>

/* NEUMORPHIC PREMIUM UI */

body{
margin:0;
font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto;
background:#e6ebf2;
color:#2d3748;
}

.container{
max-width:900px;
margin:auto;
padding:20px;
}

.title{
text-align:center;
font-size:32px;
font-weight:700;
margin-bottom:20px;
}

.neu-card{
background:#e6ebf2;
border-radius:20px;
padding:20px;
box-shadow:
10px 10px 20px #c5cad1,
-10px -10px 20px #ffffff;
}

label{
font-weight:600;
display:block;
margin-top:15px;
margin-bottom:8px;
}

input,textarea{
width:100%;
padding:15px;
border:none;
border-radius:15px;
background:#e6ebf2;
box-shadow:
inset 5px 5px 10px #c5cad1,
inset -5px -5px 10px #ffffff;
font-size:16px;
outline:none;
}

textarea{
height:120px;
resize:none;
}

button{
margin-top:10px;
padding:12px;
border:none;
border-radius:15px;
background:#e6ebf2;
box-shadow:
5px 5px 10px #c5cad1,
-5px -5px 10px #ffffff;
font-weight:600;
cursor:pointer;
}

button:active{
box-shadow:
inset 5px 5px 10px #c5cad1,
inset -5px -5px 10px #ffffff;
}

.viewer{
display:none;
}

.notification{
margin-bottom:15px;
padding:15px;
border-radius:15px;
background:#e6ebf2;
box-shadow:
5px 5px 10px #c5cad1,
-5px -5px 10px #ffffff;
}

.app{
font-weight:700;
font-size:18px;
}

.sender{
font-weight:600;
margin-top:4px;
}

.message{
margin-top:4px;
}

.time{
font-size:12px;
margin-top:6px;
color:#666;
}

.error{
color:red;
font-weight:600;
margin-top:10px;
}

</style>
</head>
<body>

<div class="container">

<div id="inputSection">

<div class="title">Apps Analytics Viewer</div>

<div class="neu-card">

<label>Load from Link</label>
<input id="linkInput"
value="https://raw.githubusercontent.com/MOFO-UG/ControlTheWorld/main/SM-E156B/Example/18-02-2026/example.json">
<button onclick="loadFromLink()">Load</button>

<label>Paste JSON</label>
<textarea id="pasteInput"></textarea>
<button onclick="loadFromPaste()">Load</button>

<label>Select File</label>
<input type="file" id="fileInput">
<button onclick="loadFromFile()">Load</button>

<div id="errorBox" class="error"></div>

</div>
</div>

<div id="viewer" class="viewer"></div>

</div>

<script>

let notifications=[];


/* LOAD FROM LINK */

async function loadFromLink(){

clearError();

try{

const url=document.getElementById("linkInput").value;

const res=await fetch(url);

const text=await res.text();

processJSON(text);

}catch(e){

showError("Failed to load from link");

}

}


/* LOAD FROM PASTE */

function loadFromPaste(){

clearError();

const text=document.getElementById("pasteInput").value;

processJSON(text);

}


/* LOAD FROM FILE */

function loadFromFile(){

clearError();

const file=document.getElementById("fileInput").files[0];

if(!file){

showError("Please select file");

return;

}

const reader=new FileReader();

reader.onload=function(e){

processJSON(e.target.result);

};

reader.readAsText(file);

}


/* SAFE JSON PROCESSOR */

function processJSON(text){

try{

const parsed=JSON.parse(text);

/* VALIDATION */

if(!Array.isArray(parsed)){

showError("JSON must be array");

return;

}

notifications=parsed;

/* CHECK EMPTY */

if(notifications.length===0){

showError("No notifications found");

return;

}

/* SUCCESS */

hideInput();

renderNotifications();

}catch(e){

showError("Invalid JSON or corrupted file");

}

}


/* RENDER ENGINE */

function renderNotifications(){

const viewer=document.getElementById("viewer");

viewer.innerHTML="";

notifications.sort((a,b)=>b.posted_time-a.posted_time);

notifications.forEach(n=>{

const app=n.app_name||"Unknown App";

const sender=n.title||"";

const message=n.text||n.big_text||n.ticker||"";

const time=n.posted_time
?new Date(n.posted_time).toLocaleString()
:"";

viewer.innerHTML+=`

<div class="notification">

<div class="app">${escapeHTML(app)}</div>

<div class="sender">${escapeHTML(sender)}</div>

<div class="message">${escapeHTML(message)}</div>

<div class="time">${escapeHTML(time)}</div>

</div>

`;

});

}


/* UI CONTROL */

function hideInput(){

document.getElementById("inputSection").style.display="none";

document.getElementById("viewer").style.display="block";

}


/* ERROR HANDLING */

function showError(msg){

document.getElementById("errorBox").innerText=msg;

}

function clearError(){

document.getElementById("errorBox").innerText="";

}


/* SECURITY */

function escapeHTML(str){

if(!str) return "";

return str.replace(/[&<>"']/g,function(m){

return{

"&":"&amp;",
"<":"&lt;",
">":"&gt;",
"\"":"&quot;",
"'":"&#039;"

}[m];

});

}

</script>

</body>
</html>
